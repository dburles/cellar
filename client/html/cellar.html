<head>
  <title>Wine Cellar</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/ios/touch-icon-iphone.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/images/ios/touch-icon-ipad.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/images/ios/touch-icon-iphone-retina.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/images/ios/touch-icon-ipad-retina.png" />
</head>

<body>
  {{> application}}
</body>

<template name="application">
  {{#unless modal}}
    {{> nav}}
    
    <div class="wrapper">
      {{{view data}}}
    </div>
  {{else}}
    {{> promptModal}}
  {{/unless}}
</template>

<template name="promptModal">
  <div class="prompt modal">
    <div class="modal-header">
      <h3>Are you sure?</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you wish to permanently delete this wine?</p>
    </div>
    <div class="modal-footer">
      <a href="" class="btn cancel pull-left">Cancel</a>
      <a href="" class="btn btn-danger delete">Delete</a>
    </div>
  </div>
</template>

<template name="signIn">
  <h2>Please sign in to access your wine cellar.</h2>
</template>

<template name="home">
  {{> list wines}}
</template>

<template name="archive">
  <h1>ARCHIVE</h1>
  {{> list wines}}
</template>

<template name="not_found">
  <h1>Page not found</h1>
</template>

<template name="nav">
  <div class="navbar">
    <div class="navbar-inner">
      <a class="brand" href="{{pathFor 'home'}}">Wine Cellar</a>
      {{#if currentUser}}
        <ul class="nav">
          <li>
            <a href="add"><i class="icon-glass icon-white"></i> Add a new wine</a>
          </li>
          <li>
            <a href="home"><i class="icon-list icon-white"></i> Home</a>
          </li>
          <li>
            <a href="archive"><i class="icon-time icon-white"></i> Archive</a>
          </li>
        </ul>
      {{/if}}
      <ul class="nav pull-right">
        {{#if currentUser}}
          <li>
            <a>{{totalWines}}</a>
          </li>
          <li>
            <a>{{totalValue}}</a>
          </li>
        {{/if}}
        <li>
          {{loginButtons}}
        </li>
      </ul>
    </div>
  </div>
</template>

<template name="edit">
  {{#with wine}}
    {{> form}}
  {{/with}}
</template>

<template name="add">
  {{> form}}
</template>

<template name="select">
  <select name="{{name}}" class="input-xlarge">  
    {{#each decoratedOptions}}
      <option value="{{value}}" {{#if selected}}selected{{/if}}>{{name}}</option>
    {{/each}}
  </select>
</template>

<template name="form">
  <form id="form" class="form-horizontal {{visibility}}">
    <div class="row">
      <div class="span9">
        <fieldset>
          <div class="control-group">
            <label for="" class="control-label">&nbsp;</label>
            <div class="controls">
              {{#unless _id}}
                <h1>NEW</h1>
              {{else}}
                <h1>EDIT</h1>
              {{/unless}}
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="qty">Quantity</label>
            <div class="controls">
              {{> select selectOptionsQty}}
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="year">Year</label>
            <div class="controls">
              <input value="{{year}}" type="text" name="year" placeholder="" class="input-xlarge">
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="name">Name</label>
            <div class="controls">
              <input value="{{name}}" type="text" name="name" placeholder="" class="input-xlarge">
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="winery">Winery</label>
            <div class="controls">
              <input value="{{winery}}" type="text" name="winery" placeholder="" class="input-xlarge">
            </div>
          </div>
          {{#each wineries}}
          <div class="control-group">
            <label for="" class="control-label">&nbsp;</label>
            <div class="controls autocomplete-winery">
              <a class="ac" href="">{{name}}</a>
            </div>
          </div>
          {{/each}}
          <div class="control-group">
             <!-- Text input-->
            <label class="control-label" for="description">Description</label>
            <div class="controls">
              <input value="{{description}}" type="text" name="description" placeholder="" class="input-xlarge">
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="type">Variety</label>
            <div class="controls">
              <input value="{{type}}" type="text" name="type" placeholder="" class="input-xlarge">
            </div>
          </div>
          {{#each varieties}}
          <div class="control-group">
            <label for="" class="control-label">&nbsp;</label>
            <div class="controls autocomplete-type">
              <a class="ac" href="">{{name}}</a>
            </div>
          </div>
          {{/each}}
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="region">Region</label>
            <div class="controls">
              <input value="{{region}}" type="text" name="region" placeholder="" class="input-xlarge">
            </div>
          </div>
          {{#each regions}}
          <div class="control-group">
            <label for="" class="control-label">&nbsp;</label>
            <div class="controls autocomplete-region">
              <a class="ac" href="">{{name}}</a>
            </div>
          </div>
          {{/each}}
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="drink_by">Drink By</label>
            <div class="controls">
              <input value="{{drink_by}}" type="text" name="drink_by" placeholder="" class="input-xlarge">
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="purchased">Purchased</label>
            <div class="controls">
              <input value="{{purchased}}" type="text" name="purchased" placeholder="" class="input-xlarge">
            </div>
          </div>
          <div class="control-group">
            <!-- Text input-->
            <label class="control-label" for="price">Price</label>
            <div class="controls">
              <input value="{{price}}" type="text" name="price" placeholder="" class="input-xlarge">
            </div>
          </div>
          <div class="control-group">
            <!-- Select Basic -->
            <label for="rating" class="control-label">Rating</label>
            <div class="controls">
              {{> select selectOptionsRating}}
            </div>
          </div>
          <div class="control-group">
            <!-- Textarea -->
            <label for="notes" class="control-label">Notes</label>
            <div class="controls">
              <div class="textarea-xlarge">
                <textarea name="notes" type="" class="">{{notes}}</textarea>
              </div>
            </div>
          </div>
          <div class="control-group">
            <label class="control-label"></label>
            <div class="controls">
              <a id="save" class="btn btn-primary btn-large">Save</a>
              <a id="cancel" class="btn right btn-large" style="float: right">Cancel</a>
              {{#if _id}}
                <a id="delete" class="btn btn-danger btn-mini right" style="float: right; margin-right: 5px"><i class="icon-remove icon-white"></i> Delete</a>
              {{/if}}
            </div>
          </div>
        </fieldset>
      </div>
    </div>
  </form>
</template>

<template name="list">
  {{> search}}
  <div class="container">
    {{#each this}}
      {{> item}}
    {{/each}}
  </div>
</template>

<template name="search">
  <div id="search-container">
    <input type="text" name="search" id="search" value="{{search}}" placeholder="Search year, name, winery, type and region. To search bottle numbers prefix with #">
    {{#if hasSearch}}
      <span class="clear">Clear</span>
    {{/if}}
  </div>
</template>

<template name="item">
  <div class="item">
    <h2><span class="badge ref">#{{ref}}</span> <a href="" class="edit">{{year}} {{winery}}</a></h2>
    <h3>{{type}}</h3>
    <h4>{{region}}</h4>
    <p>{{notes}}</p>
    {{#if drink_by}}
      <p>Drink by {{drink_by}}</p>
    {{/if}}
    
    <span class="badge">x {{qty}}</span>
    {{#if price}}
      <span class="badge">${{price}}</span>
    {{/if}}
    {{#if rating}}
      <span class="badge">{{rating}}/10</span>
    {{/if}}
  </div>
</template>

<template name="listOld">
  {{#if hasWines}}
    <table class="table table-striped table-condensed">
      <thead>
        <tr>
          <th><a id="ref">#</a></th>
          <th><a id="name">Name</a></th>
          <th><a id="type">Type</a></th>
          <th><a id="description">Description</a></th>
          <th><a id="winery">Winery</a></th>
          <th><a id="region">Region</a></th>
          <th><a id="year">Year</a></th>
          <th><a id="qty">Qty</a></th>        
          <th><a id="drink_by">Drink By</a></th>
          <th><a id="purchased">Purchased</a></th>
          <th><a id="price">Price</a></th>
          <th><a id="rating">Rating</a></th>
        </tr>
      </thead>
      <tbody>    
        {{#each wines}}
          <tr>
            <td>{{ref}}</td>
            <td>{{name}}</td>
            <td>{{type}}</td>
            <td>{{description}}</td>          
            <td>{{winery}}</td>
            <td>{{region}}</td>
            <td>{{year}}</td>
            <td>{{qty}}</td>          
            <td>{{drink_by}}</td>
            <td>{{purchased}}</td>
            <td>{{price}}</td>
            <td>{{rating}}</td>
            <td class="edit"><a><i class="icon-edit"></i></a></td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{/if}}
</template>
